<div class="container">
    <pre id=json class=json-container></pre>
    <pre id=json2 class=json-container></pre>
    <style>

    </style>
    <script>
        tree = [];
        depthCount = 0;
        ListOnRoot().then(array => {

            array.forEach(e => {

                const item = new Item(e, e, IsFolder(e), []);
                tree.push(item)

                NestTree(item);
            });

            console.log(tree)


            document.getElementById("json").innerHTML = prettyPrintJson.toHtml(tree);

        });;


        /////////////////////////////////////////////////////////////////////////////
        // >function /////////////////////////////////////////////////////////////////////////////
        /////////////////////////////////////////////////////////////////////////////


        function json_tree(object) {
            var json = "<ul>";
            for (prop in object) {
                console.log('key: ' + prop);
                console.log('val: ' + JSON.stringify(object[prop]));
                var value = object[prop];
                switch (typeof(value)) {
                    case "object":
                        console.log('object');
                        json += "<li>" + value.menu + json_tree(value.childs) + "</li>";
                        break;
                    default:
                        console.log('not obj');
                        json += "<li>" + value.menu + "</li>";
                }
            }
            return json + "</ul>";
        }















        class Item {
            constructor(path, name, isFolder, child) {
                this.path = path;
                this.name = name;
                this.isFolder = isFolder;
                this.child = child;
            }
        }

        function NestTree(Parent) {
            if (Parent.isFolder) {
                ListOnPath(Parent.path).then(array =>

                    array.forEach(child => {

                        const item = new Item(
                            Parent.path + "/" + child,
                            child,
                            IsFolder(child), []
                        );

                        Parent.child.push(item);

                        if (Parent.isFolder) {
                            NestTree(item);
                        }

                    })
                );
            }

        }

        function IsFolder(path) {
            return !path.includes(".");
        }
        async function ListOnRoot() {
            const user = "LaiHoYan";
            const repo = "laihoyan.github.io";
            const url = `https://api.github.com/repos/${user}/${repo}/git/trees/main`;
            const list = await fetch(url).then(res => res.json());
            return list.tree.map(node => node.path);
        }
        async function ListOnPath(path) {
            const user = "LaiHoYan";
            const repo = "laihoyan.github.io";
            const url = `https://api.github.com/repos/${user}/${repo}/git/trees/main`;
            path = path.split('/').filter(Boolean);
            const dir = await path.reduce(async(acc, dir) => {
                const {
                    url
                } = await acc;
                const list = await fetch(url).then(res => res.json());
                return list.tree.find(node => node.path === dir);
            }, {
                url
            });

            if (dir) {
                const list = await fetch(dir.url).then(res => res.json());
                map = list.tree.map(node => node.path);
                return map;
            }
        }
        /////////////////////////////////////////////////////////////////////////////
        // function> /////////////////////////////////////////////////////////////////////////////
        /////////////////////////////////////////////////////////////////////////////
    </script>
    <link rel=stylesheet href=https://cdn.jsdelivr.net/npm/pretty-print-json@2.1/dist/css/pretty-print-json.css>
    <script src=https://cdn.jsdelivr.net/npm/pretty-print-json@2.1/dist/pretty-print-json.min.js></script>